<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="manifest" href="manifest.json">
<title>CHUGGED TO DEATH</title>

<style>
:root {
  --metal-black: #0a0a0a;
  --blood-red: #8b0000;
  --chrome: #c0c0c0;
}

html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: var(--metal-black);
  font-family: Courier New, monospace;
  touch-action: none;
}

#game-container {
  position: relative;
  width: 100vw;
  height: 100vh;
}

canvas {
  display: block;
  background: #111;
}

.controls {
  position: absolute;
  bottom: 30px;
  width: 100%;
  display: flex;
  justify-content: space-between;
  padding: 0 40px;
  pointer-events: none;
  z-index: 10;
}

.btn-group {
  display: flex;
  gap: 20px;
  pointer-events: auto;
}

.btn {
  width: 80px;
  height: 80px;
  background: rgba(139,0,0,0.3);
  border: 3px solid rgba(192,192,192,0.5);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 28px;
  color: white;
  user-select: none;
}

.btn:active {
  background: var(--blood-red);
  transform: scale(0.9);
}

#orientation-warning {
  display: none;
  position: fixed;
  inset: 0;
  background: var(--metal-black);
  color: white;
  text-align: center;
  padding-top: 20%;
  z-index: 100;
}

@media (orientation: portrait) {
  #orientation-warning { display: block; }
}
</style>
</head>

<body>

<div id="orientation-warning">ü§ò ROTATE TO LANDSCAPE TO SHRED ü§ò</div>

<div id="game-container">
  <canvas id="gameCanvas"></canvas>

  <div class="controls">
    <div class="btn-group">
      <div id="btn-left" class="btn">‚Üê</div>
      <div id="btn-right" class="btn">‚Üí</div>
    </div>
    <div class="btn-group">
      <div id="btn-jump" class="btn">J</div>
      <div id="btn-shoot" class="btn">ü§ò</div>
    </div>
  </div>
</div>

<script>
/* =========================
   CANVAS SETUP
========================= */
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

/* =========================
   SPRITE DEFINITIONS
========================= */
const SPRITES = {
  idle: {
    fps: 4,
    frames: ["IMG_5163.jpeg"]
  },
  shoot: {
    fps: 8,
    frames: ["IMG_5164.jpeg", "IMG_5165.jpeg"]
  }
};

/* =========================
   SPRITE MANAGER
========================= */
class SpriteManager {
  constructor(defs) {
    this.defs = defs;
    this.images = {};
  }

  load() {
    Object.entries(this.defs).forEach(([state, def]) => {
      this.images[state] = [];
      def.frames.forEach(src => {
        const img = new Image();
        img.onload = () => img._ready = true;
        img.onerror = () => console.warn("Sprite failed:", src);
        img.src = src;
        this.images[state].push(img);
      });
    });
  }

  getFrame(state, time) {
    const def = this.defs[state];
    const frames = this.images[state];
    if (!def || !frames || frames.length === 0) return null;

    const index =
      Math.floor(time / (1000 / def.fps)) % frames.length;

    const img = frames[index];
    return img && img._ready ? img : null;
  }
}

const spriteManager = new SpriteManager(SPRITES);
spriteManager.load();

/* =========================
   GAME CONSTANTS
========================= */
const GRAVITY = 0.6;
const SHRED_SPEED = 10;
let width, height, floorY;

/* =========================
   PLAYER STATE
========================= */
const player = {
  x: 100,
  y: 0,
  w: 60,
  h: 80,
  vx: 0,
  vy: 0,
  grounded: false,
  direction: 1,
  state: "idle"
};

const keys = { left:false, right:false, jump:false, shoot:false };
const notes = [];
const enemies = [];
let lastShot = 0;

/* =========================
   RESIZE
========================= */
function resize() {
  width = window.innerWidth;
  height = window.innerHeight;
  canvas.width = width;
  canvas.height = height;
  floorY = height - 160;
  player.y = floorY - player.h;
}

/* =========================
   INPUT
========================= */
function bindBtn(id, key) {
  const el = document.getElementById(id);
  el.addEventListener("touchstart", e => {
    e.preventDefault(); keys[key] = true;
  });
  el.addEventListener("touchend", e => {
    e.preventDefault(); keys[key] = false;
  });
}

bindBtn("btn-left", "left");
bindBtn("btn-right", "right");
bindBtn("btn-jump", "jump");
bindBtn("btn-shoot", "shoot");

/* =========================
   UPDATE
========================= */
function update() {
  if (keys.shoot) player.state = "shoot";
  else if (!player.grounded) player.state = "jump";
  else if (keys.left || keys.right) player.state = "walk";
  else player.state = "idle";

  if (keys.left) { player.vx = -5; player.direction = -1; }
  else if (keys.right) { player.vx = 5; player.direction = 1; }
  else player.vx *= 0.8;

  if (keys.jump && player.grounded) {
    player.vy = -14;
    player.grounded = false;
  }

  if (keys.shoot && Date.now() - lastShot > 200) {
    notes.push({
      x: player.x + (player.direction === 1 ? player.w : 0),
      y: player.y + 35,
      vx: player.direction * SHRED_SPEED,
      symbol: "‚ô´"
    });
    lastShot = Date.now();
  }

  player.x += player.vx;
  player.y += player.vy;
  player.vy += GRAVITY;

  if (player.y > floorY - player.h) {
    player.y = floorY - player.h;
    player.vy = 0;
    player.grounded = true;
  }

  notes.forEach((n, i) => {
    n.x += n.vx;
    if (n.x < 0 || n.x > width) notes.splice(i, 1);
  });
}

/* =========================
   DRAW
========================= */
function draw() {
  ctx.clearRect(0,0,width,height);

  ctx.fillStyle = "#1a1a1a";
  ctx.fillRect(0, floorY, width, height - floorY);

  ctx.save();
  ctx.translate(player.x + player.w/2, player.y + player.h/2);
  ctx.scale(player.direction, 1);

  const sprite = spriteManager.getFrame(
    player.state,
    performance.now()
  );

  if (sprite) {
    ctx.drawImage(sprite, -player.w/2, -player.h/2, player.w, player.h);
  } else {
    ctx.fillStyle = "#fff";
    ctx.fillRect(-player.w/2, -player.h/2, player.w, player.h);
    ctx.fillStyle = "#8b0000";
    ctx.fillRect(0, 0, 30, 5);
  }

  ctx.restore();

  ctx.fillStyle = "#00f0ff";
  ctx.font = "24px Arial";
  notes.forEach(n => ctx.fillText(n.symbol, n.x, n.y));
}

/* =========================
   LOOP
========================= */
function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

window.addEventListener("resize", resize);
resize();
loop();
</script>

</body>
</html>